2025-12-02 11:15:26 - __main__ - INFO - ================================================================================
2025-12-02 11:15:26 - __main__ - INFO - COMPARISON EXPERIMENT: Direct vs Transform-Enhanced Detection
2025-12-02 11:15:26 - __main__ - INFO - ================================================================================
2025-12-02 11:15:26 - __main__ - INFO - Task: polarity
2025-12-02 11:15:26 - __main__ - INFO - Model: data/polarity/outputs/final_model
2025-12-02 11:15:26 - __main__ - INFO - Train samples: 1000
2025-12-02 11:15:26 - __main__ - INFO - Test samples: 400
2025-12-02 11:15:26 - __main__ - INFO - Transform: prefix_negation
2025-12-02 11:15:26 - __main__ - INFO - 
2025-12-02 11:15:26 - __main__ - INFO - Loading model...
2025-12-02 11:15:30 - __main__ - INFO - Loading data...
2025-12-02 11:15:30 - __main__ - INFO - Loaded 50 total poisoned indices, 50 in subset
2025-12-02 11:15:30 - __main__ - INFO - Loaded 1000 train samples, 50 poisoned
2025-12-02 11:15:30 - __main__ - INFO - Loaded 200 test samples
2025-12-02 11:15:30 - __main__ - INFO - Processing test samples 350:400 out of 200
2025-12-02 11:15:30 - __main__ - INFO - 
================================================================================
2025-12-02 11:15:30 - __main__ - INFO - STEP 1: Computing original influence scores
2025-12-02 11:15:30 - __main__ - INFO - ================================================================================
2025-12-02 11:15:30 - __main__ - INFO - Computing influence for: original
2025-12-02 11:15:30 - __main__ - INFO - Computing influence factors...
[W1202 11:15:30.816975973 Context.cpp:456] Warning: torch.backends.cuda.preferred_linalg_library is an experimental feature. If you see any error or unexpected behavior when this flag is set please file an issue on GitHub. (function operator())
2025-12-02 11:15:30 - poison_detection.influence.analyzer - INFO - Using magma backend for linear algebra
2025-12-02 11:15:30 - poison_detection.influence.analyzer - INFO - Using eigendecomposition dtype: torch.float64
2025-12-02 11:15:30 - poison_detection.influence.analyzer - INFO - Damping factor for scores: 1e-05
Performing Eigendecomposition [0/145]   0%|           [time left: ?, time spent: 00:00]Performing Eigendecomposition [1/145]   1%|           [time left: 04:15, time spent: 00:01]Performing Eigendecomposition [2/145]   1%|▏          [time left: 02:38, time spent: 00:02]Performing Eigendecomposition [3/145]   2%|▏          [time left: 02:03, time spent: 00:03]Performing Eigendecomposition [4/145]   3%|▎          [time left: 01:48, time spent: 00:03]Performing Eigendecomposition [5/145]   3%|▎          [time left: 03:04, time spent: 00:05]Performing Eigendecomposition [6/145]   4%|▍          [time left: 03:36, time spent: 00:07]Performing Eigendecomposition [7/145]   5%|▍          [time left: 03:57, time spent: 00:09]Performing Eigendecomposition [8/145]   6%|▌          [time left: 03:08, time spent: 00:10]Performing Eigendecomposition [9/145]   6%|▌          [time left: 02:35, time spent: 00:11]Performing Eigendecomposition [10/145]   7%|▋          [time left: 02:11, time spent: 00:11]Performing Eigendecomposition [11/145]   8%|▊          [time left: 01:58, time spent: 00:12]Performing Eigendecomposition [12/145]   8%|▊          [time left: 02:44, time spent: 00:14]Performing Eigendecomposition [13/145]   9%|▉          [time left: 03:15, time spent: 00:16]Performing Eigendecomposition [14/145]  10%|▉          [time left: 03:39, time spent: 00:18]Performing Eigendecomposition [15/145]  10%|█          [time left: 02:56, time spent: 00:19]Performing Eigendecomposition [16/145]  11%|█          [time left: 02:27, time spent: 00:20]Performing Eigendecomposition [17/145]  12%|█▏         [time left: 02:06, time spent: 00:20]Performing Eigendecomposition [18/145]  12%|█▏         [time left: 01:50, time spent: 00:21]Performing Eigendecomposition [19/145]  13%|█▎         [time left: 02:34, time spent: 00:23]Performing Eigendecomposition [20/145]  14%|█▍         [time left: 03:06, time spent: 00:25]Performing Eigendecomposition [21/145]  14%|█▍         [time left: 03:20, time spent: 00:27]Performing Eigendecomposition [22/145]  15%|█▌         [time left: 02:38, time spent: 00:27]Performing Eigendecomposition [23/145]  16%|█▌         [time left: 02:10, time spent: 00:28]Performing Eigendecomposition [24/145]  17%|█▋         [time left: 01:51, time spent: 00:28]Performing Eigendecomposition [25/145]  17%|█▋         [time left: 01:37, time spent: 00:29]Performing Eigendecomposition [26/145]  18%|█▊         [time left: 02:10, time spent: 00:31]Performing Eigendecomposition [27/145]  19%|█▊         [time left: 02:40, time spent: 00:33]Performing Eigendecomposition [28/145]  19%|█▉         [time left: 02:54, time spent: 00:35]Performing Eigendecomposition [29/145]  20%|██         [time left: 02:19, time spent: 00:35]Performing Eigendecomposition [30/145]  21%|██         [time left: 01:56, time spent: 00:36]Performing Eigendecomposition [31/145]  21%|██▏        [time left: 01:39, time spent: 00:36]Performing Eigendecomposition [32/145]  22%|██▏        [time left: 01:29, time spent: 00:37]Performing Eigendecomposition [33/145]  23%|██▎        [time left: 02:02, time spent: 00:39]Performing Eigendecomposition [34/145]  23%|██▎        [time left: 02:25, time spent: 00:40]Performing Eigendecomposition [35/145]  24%|██▍        [time left: 02:41, time spent: 00:42]Performing Eigendecomposition [36/145]  25%|██▍        [time left: 02:10, time spent: 00:43]Performing Eigendecomposition [37/145]  26%|██▌        [time left: 01:49, time spent: 00:43]Performing Eigendecomposition [38/145]  26%|██▌        [time left: 01:34, time spent: 00:44]Performing Eigendecomposition [39/145]  27%|██▋        [time left: 01:23, time spent: 00:45]Performing Eigendecomposition [40/145]  28%|██▊        [time left: 01:52, time spent: 00:46]Performing Eigendecomposition [41/145]  28%|██▊        [time left: 02:12, time spent: 00:48]Performing Eigendecomposition [42/145]  29%|██▉        [time left: 02:28, time spent: 00:50]Performing Eigendecomposition [43/145]  30%|██▉        [time left: 01:59, time spent: 00:50]Performing Eigendecomposition [44/145]  30%|███        [time left: 01:39, time spent: 00:51]Performing Eigendecomposition [45/145]  31%|███        [time left: 01:25, time spent: 00:52]Performing Eigendecomposition [46/145]  32%|███▏       [time left: 01:15, time spent: 00:52]Performing Eigendecomposition [47/145]  32%|███▏       [time left: 01:44, time spent: 00:54]Performing Eigendecomposition [48/145]  33%|███▎       [time left: 02:03, time spent: 00:56]Performing Eigendecomposition [49/145]  34%|███▍       [time left: 02:15, time spent: 00:57]Performing Eigendecomposition [50/145]  34%|███▍       [time left: 01:50, time spent: 00:58]Performing Eigendecomposition [51/145]  35%|███▌       [time left: 01:31, time spent: 00:58]Performing Eigendecomposition [52/145]  36%|███▌       [time left: 01:19, time spent: 00:59]Performing Eigendecomposition [53/145]  37%|███▋       [time left: 01:10, time spent: 01:00]Performing Eigendecomposition [54/145]  37%|███▋       [time left: 01:39, time spent: 01:01]Performing Eigendecomposition [55/145]  38%|███▊       [time left: 01:58, time spent: 01:03]Performing Eigendecomposition [56/145]  39%|███▊       [time left: 02:10, time spent: 01:05]Performing Eigendecomposition [57/145]  39%|███▉       [time left: 01:43, time spent: 01:06]Performing Eigendecomposition [58/145]  40%|████       [time left: 01:25, time spent: 01:06]Performing Eigendecomposition [59/145]  41%|████       [time left: 01:12, time spent: 01:07]Performing Eigendecomposition [60/145]  41%|████▏      [time left: 01:03, time spent: 01:07]Performing Eigendecomposition [61/145]  42%|████▏      [time left: 00:57, time spent: 01:08]Performing Eigendecomposition [62/145]  43%|████▎      [time left: 00:57, time spent: 01:08]Performing Eigendecomposition [63/145]  43%|████▎      [time left: 00:56, time spent: 01:09]Performing Eigendecomposition [64/145]  44%|████▍      [time left: 00:54, time spent: 01:10]Performing Eigendecomposition [65/145]  45%|████▍      [time left: 01:27, time spent: 01:12]Performing Eigendecomposition [66/145]  46%|████▌      [time left: 01:48, time spent: 01:14]Performing Eigendecomposition [67/145]  46%|████▌      [time left: 02:01, time spent: 01:16]Performing Eigendecomposition [68/145]  47%|████▋      [time left: 01:38, time spent: 01:16]Performing Eigendecomposition [69/145]  48%|████▊      [time left: 01:20, time spent: 01:17]Performing Eigendecomposition [70/145]  48%|████▊      [time left: 01:09, time spent: 01:18]Performing Eigendecomposition [71/145]  49%|████▉      [time left: 01:00, time spent: 01:18]Performing Eigendecomposition [72/145]  50%|████▉      [time left: 00:54, time spent: 01:19]Performing Eigendecomposition [73/145]  50%|█████      [time left: 00:50, time spent: 01:19]Performing Eigendecomposition [74/145]  51%|█████      [time left: 00:48, time spent: 01:20]Performing Eigendecomposition [75/145]  52%|█████▏     [time left: 00:45, time spent: 01:21]Performing Eigendecomposition [76/145]  52%|█████▏     [time left: 01:12, time spent: 01:23]Performing Eigendecomposition [77/145]  53%|█████▎     [time left: 01:31, time spent: 01:25]Performing Eigendecomposition [78/145]  54%|█████▍     [time left: 01:44, time spent: 01:27]Performing Eigendecomposition [79/145]  54%|█████▍     [time left: 01:24, time spent: 01:27]Performing Eigendecomposition [80/145]  55%|█████▌     [time left: 01:10, time spent: 01:28]Performing Eigendecomposition [81/145]  56%|█████▌     [time left: 01:00, time spent: 01:29]Performing Eigendecomposition [82/145]  57%|█████▋     [time left: 00:52, time spent: 01:29]Performing Eigendecomposition [83/145]  57%|█████▋     [time left: 00:47, time spent: 01:30]Performing Eigendecomposition [84/145]  58%|█████▊     [time left: 00:44, time spent: 01:30]Performing Eigendecomposition [85/145]  59%|█████▊     [time left: 00:41, time spent: 01:31]Performing Eigendecomposition [86/145]  59%|█████▉     [time left: 00:38, time spent: 01:32]Performing Eigendecomposition [87/145]  60%|██████     [time left: 01:02, time spent: 01:34]Performing Eigendecomposition [88/145]  61%|██████     [time left: 01:16, time spent: 01:36]Performing Eigendecomposition [89/145]  61%|██████▏    [time left: 01:27, time spent: 01:38]Performing Eigendecomposition [90/145]  62%|██████▏    [time left: 01:11, time spent: 01:38]Performing Eigendecomposition [91/145]  63%|██████▎    [time left: 00:57, time spent: 01:39]Performing Eigendecomposition [92/145]  63%|██████▎    [time left: 00:49, time spent: 01:39]Performing Eigendecomposition [93/145]  64%|██████▍    [time left: 00:43, time spent: 01:40]Performing Eigendecomposition [94/145]  65%|██████▍    [time left: 00:38, time spent: 01:41]Performing Eigendecomposition [95/145]  66%|██████▌    [time left: 00:36, time spent: 01:41]Performing Eigendecomposition [96/145]  66%|██████▌    [time left: 00:34, time spent: 01:42]Performing Eigendecomposition [97/145]  67%|██████▋    [time left: 00:32, time spent: 01:43]Performing Eigendecomposition [98/145]  68%|██████▊    [time left: 00:49, time spent: 01:44]Performing Eigendecomposition [99/145]  68%|██████▊    [time left: 01:00, time spent: 01:46]Performing Eigendecomposition [100/145]  69%|██████▉    [time left: 01:08, time spent: 01:48]Performing Eigendecomposition [101/145]  70%|██████▉    [time left: 00:55, time spent: 01:49]Performing Eigendecomposition [102/145]  70%|███████    [time left: 00:45, time spent: 01:50]Performing Eigendecomposition [103/145]  71%|███████    [time left: 00:38, time spent: 01:50]Performing Eigendecomposition [104/145]  72%|███████▏   [time left: 00:33, time spent: 01:51]Performing Eigendecomposition [105/145]  72%|███████▏   [time left: 00:29, time spent: 01:51]Performing Eigendecomposition [106/145]  73%|███████▎   [time left: 00:26, time spent: 01:52]Performing Eigendecomposition [107/145]  74%|███████▍   [time left: 00:25, time spent: 01:53]Performing Eigendecomposition [108/145]  74%|███████▍   [time left: 00:24, time spent: 01:53]Performing Eigendecomposition [109/145]  75%|███████▌   [time left: 00:37, time spent: 01:55]Performing Eigendecomposition [110/145]  76%|███████▌   [time left: 00:46, time spent: 01:57]Performing Eigendecomposition [111/145]  77%|███████▋   [time left: 00:51, time spent: 01:59]Performing Eigendecomposition [112/145]  77%|███████▋   [time left: 00:40, time spent: 02:00]Performing Eigendecomposition [113/145]  78%|███████▊   [time left: 00:33, time spent: 02:00]Performing Eigendecomposition [114/145]  79%|███████▊   [time left: 00:28, time spent: 02:01]Performing Eigendecomposition [115/145]  79%|███████▉   [time left: 00:24, time spent: 02:01]Performing Eigendecomposition [116/145]  80%|████████   [time left: 00:22, time spent: 02:02]Performing Eigendecomposition [117/145]  81%|████████   [time left: 00:19, time spent: 02:03]Performing Eigendecomposition [118/145]  81%|████████▏  [time left: 00:18, time spent: 02:03]Performing Eigendecomposition [119/145]  82%|████████▏  [time left: 00:17, time spent: 02:04]Performing Eigendecomposition [120/145]  83%|████████▎  [time left: 00:26, time spent: 02:06]Performing Eigendecomposition [121/145]  83%|████████▎  [time left: 00:32, time spent: 02:08]Performing Eigendecomposition [122/145]  84%|████████▍  [time left: 00:35, time spent: 02:10]Performing Eigendecomposition [123/145]  85%|████████▍  [time left: 00:27, time spent: 02:11]Performing Eigendecomposition [124/145]  86%|████████▌  [time left: 00:22, time spent: 02:11]Performing Eigendecomposition [125/145]  86%|████████▌  [time left: 00:18, time spent: 02:12]Performing Eigendecomposition [126/145]  87%|████████▋  [time left: 00:15, time spent: 02:12]Performing Eigendecomposition [127/145]  88%|████████▊  [time left: 00:13, time spent: 02:13]Performing Eigendecomposition [128/145]  88%|████████▊  [time left: 00:12, time spent: 02:14]Performing Eigendecomposition [129/145]  89%|████████▉  [time left: 00:11, time spent: 02:14]Performing Eigendecomposition [130/145]  90%|████████▉  [time left: 00:10, time spent: 02:15]Performing Eigendecomposition [131/145]  90%|█████████  [time left: 00:15, time spent: 02:17]Performing Eigendecomposition [132/145]  91%|█████████  [time left: 00:17, time spent: 02:19]Performing Eigendecomposition [133/145]  92%|█████████▏ [time left: 00:18, time spent: 02:21]Performing Eigendecomposition [134/145]  92%|█████████▏ [time left: 00:13, time spent: 02:22]Performing Eigendecomposition [135/145]  93%|█████████▎ [time left: 00:10, time spent: 02:22]Performing Eigendecomposition [136/145]  94%|█████████▍ [time left: 00:08, time spent: 02:23]Performing Eigendecomposition [137/145]  94%|█████████▍ [time left: 00:06, time spent: 02:23]Performing Eigendecomposition [138/145]  95%|█████████▌ [time left: 00:05, time spent: 02:24]Performing Eigendecomposition [139/145]  96%|█████████▌ [time left: 00:04, time spent: 02:25]Performing Eigendecomposition [140/145]  97%|█████████▋ [time left: 00:03, time spent: 02:25]Performing Eigendecomposition [141/145]  97%|█████████▋ [time left: 00:02, time spent: 02:26]Performing Eigendecomposition [142/145]  98%|█████████▊ [time left: 00:03, time spent: 02:28]Performing Eigendecomposition [143/145]  99%|█████████▊ [time left: 00:02, time spent: 02:30]Performing Eigendecomposition [144/145]  99%|█████████▉ [time left: 00:01, time spent: 02:32]Performing Eigendecomposition [145/145] 100%|██████████ [time left: 00:00, time spent: 19:33]Performing Eigendecomposition [145/145] 100%|██████████ [time left: 00:00, time spent: 19:33]
Traceback (most recent call last):
  File "/mnt/nw/home/j.li/Poison-Detection/experiments/compare_direct_vs_transform_detection.py", line 599, in <module>
    run_experiment(args)
  File "/mnt/nw/home/j.li/Poison-Detection/experiments/compare_direct_vs_transform_detection.py", line 456, in run_experiment
    original_scores = compute_influence_scores(
  File "/mnt/nw/home/j.li/Poison-Detection/experiments/compare_direct_vs_transform_detection.py", line 161, in compute_influence_scores
    analyzer.compute_factors(train_loader, factors_name="ekfac", per_device_batch_size=8)
  File "/mnt/nw/home/j.li/Poison-Detection/poison_detection/influence/analyzer.py", line 102, in compute_factors
    self.analyzer.fit_all_factors(
  File "/mnt/nw/home/j.li/.local/lib/python3.10/site-packages/kronfluence/analyzer.py", line 187, in fit_all_factors
    self.fit_lambda_matrices(
  File "/mnt/nw/home/j.li/.local/lib/python3.10/site-packages/kronfluence/computer/factor_computer.py", line 562, in fit_lambda_matrices
    eigen_factors = load_eigendecomposition(output_dir=load_factors_output_dir)
  File "/mnt/nw/home/j.li/.local/lib/python3.10/site-packages/kronfluence/factor/eigen.py", line 113, in load_eigendecomposition
    eigen_factors[factor_name] = load_file(filename=save_path)
  File "/mnt/nw/home/j.li/.local/lib/python3.10/site-packages/safetensors/torch.py", line 381, in load_file
    with safe_open(filename, framework="pt", device=device) as f:
safetensors_rust.SafetensorError: Error while deserializing header: incomplete metadata, file not fully covered
